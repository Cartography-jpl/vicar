C SUBROUTINE TO GET PHYSICAL MEMORY SIZE
        SUBROUTINE GET_MEM_SIZE(MEMSIZE,SAMP,CODE)
        INTEGER MEMSIZE,WSLIM 		! WSA IS ADJUSTMENT FOR BUFFERS ETC 
	INTEGER SAMP, CODE

	CALL SYS$ADJWSL(6000,WSLIM) ! TRY TO INCREASE WORKING SET
	MEMSIZE = MAX(200000, WSLIM*512 - 3*SAMP*CODE)
        RETURN
        END
